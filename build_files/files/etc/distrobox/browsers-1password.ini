# Distrobox configuration for browsers and 1Password
# This container provides Google Chrome, Firefox, and 1Password
# in a Fedora environment with full desktop integration.
#
# Usage:
#   distrobox assemble create --file /etc/distrobox/browsers-1password.ini
#
# The container will:
# - Install Google Chrome, Firefox, and 1Password (GUI + CLI)
# - Export all applications and the op CLI to the host
# - Enable automatic browser integration for 1Password

[browsers-1password]
# Use the official Universal Blue Fedora toolbox image
image=ghcr.io/ublue-os/fedora-toolbox:latest

# Additional packages to install
# Google Chrome repository and package
# Firefox (native Fedora package for better integration)
# 1Password GUI and CLI from official repository
additional_packages="google-chrome-stable firefox 1password 1password-cli"

# Pull the image on each assemble to ensure updates
pull=true

# Not a rootful container
root=false

# Not an init container (systemd not needed)
init=false

# Don't enable NVIDIA drivers (not needed for browsers)
nvidia=false

# Pass through USB devices for YubiKey and other hardware security keys
additional_flags="--device=/dev/bus/usb"

# Replace existing container if it exists
replace=true

# Start the container immediately after creation
start_now=true

# Pre-initialization hooks - set up repositories before package installation
# Create Google Chrome repository file
pre_init_hooks="printf '[google-chrome]\\nname=google-chrome\\nbaseurl=https://dl.google.com/linux/chrome/rpm/stable/x86_64\\nenabled=1\\ngpgcheck=1\\ngpgkey=https://dl.google.com/linux/linux_signing_key.pub\\n' | sudo tee /etc/yum.repos.d/google-chrome.repo"
# Import 1Password GPG key and create repository file
pre_init_hooks="sudo rpm --import https://downloads.1password.com/linux/keys/1password.asc"
pre_init_hooks="printf '[1password]\\nname=1Password Stable Channel\\nbaseurl=https://downloads.1password.com/linux/rpm/stable/\\044basearch\\nenabled=1\\ngpgcheck=1\\nrepo_gpgcheck=1\\ngpgkey=https://downloads.1password.com/linux/keys/1password.asc\\n' | sudo tee /etc/yum.repos.d/1password.repo"

# Exported applications and binaries
# These are automatically exported when the container is created
exported_apps="google-chrome firefox 1password"
exported_bins="/usr/bin/op"
exported_bins_path="~/.local/bin"

# Additional notes:
# - Browser integration for 1Password should work automatically
# - The container shares the home directory, so browser profiles persist
# - All exported apps will appear in the host's application menu
# - The 'op' command will be available from the host terminal
